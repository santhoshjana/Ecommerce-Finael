<div class="container container-fluid">
  <div *ngIf="cartItems.length > 0; else noCart">
    <h2 class="mt-5">Your Cart: <b>{{ cartCount }} items</b></h2>

    <div class="row d-flex justify-content-between">
      <div class="col-12 col-lg-8">
        <hr />
        <div *ngFor="let item of cartItems" class="cart-item">
          <div class="row">
            <!-- Product Image -->
            <div *ngIf="item.product?.images?.length > 0" class="col-4 col-lg-3 img-fluid" id="product_image">
              <img
                [src]="'/assets' + item.product.imageUrl"
                [alt]="item.product.name"
                height="90"
                width="115"
                class="img-fluid"
              />
            </div>

            <!-- Product Name -->
            <div class="col-5 col-lg-3">
              <a [routerLink]="['/product', item.product._id]">{{ item.product.name }}</a>
            </div>

            <!-- Price -->
            <div class="col-4 col-lg-2 mt-4 mt-lg-0">
              <p id="card_item_price">₹{{ item.product.price }}</p>
            </div>

            <!-- Quantity Controls -->
            <div class="col-4 col-lg-3 mt-4 mt-lg-0">
              <div class="stockCounter d-inline">
                <span class="btn btn-danger minus" (click)="decreaseQty(item.product._id)">-</span>
                <input
                  type="number"
                  class="form-control count d-inline"
                  [value]="item.qty"
                  readonly
                />
                <span class="btn btn-primary plus" (click)="IncreaseQty(item.product._id)">+</span>
              </div>
            </div>

            <!-- Delete Button -->
            <div class="col-4 col-lg-1 mt-4 mt-lg-0">
              <i
                id="delete_cart_item"
                class="fa fa-trash btn btn-danger"
                (click)="deleteItem(item.product._id)"
              ></i>
            </div>
          </div>
        </div>
        <hr />
      </div>

      <!-- Order Summary -->
      <div class="col-12 col-lg-3 my-4">
        <div id="order_summary">
          <h4>Order Summary</h4>
          <hr />
          <p>Subtotal: <span class="order-summary-values">{{ subTotal }} (Units)</span></p>
          <p>Est. total: <span class="order-summary-values">₹{{ estTotal }}</span></p>
          <hr />
          <button id="checkout_btn" class="btn btn-primary btn-block" (click)="orderComplete()" >Check out</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Fallback when cart is empty -->
  <ng-template #noCart>
    <h3>No cart items</h3>
  </ng-template>
</div>
